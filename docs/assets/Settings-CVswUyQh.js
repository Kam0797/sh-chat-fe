import{j as e,r as a,C as x,u as v,i as N,f as k,t as u,c as g}from"./index-CCRA2Iow.js";import{P as w}from"./PopMenuFrame-DYzW89r6.js";function j({label:m,Component:r}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"settings-item-wrapper",children:[e.jsx("label",{className:"settings-item-name f-nunito",children:m}),e.jsx("div",{className:"settings-item-action-component",children:r})]})})}const S="_uemail-wrapper_16smm_3",P="_uemail-text_16smm_11",C="_options-wrapper_16smm_19",W="_logout-button_16smm_32",d={uemailWrapper:S,uemailText:P,optionsWrapper:C,logoutButton:W};function E(){const{profileData:m,setProfileData:r}=a.useContext(x),s=v(),[c,l]=a.useState(!1),{SERVER_IP:t}=a.useContext(x);async function p(){(await k.get(t+"/auth/logout",{withCredentials:!0})).data.code&&(localStorage.setItem("isLoggedIn",!1),localStorage.setItem("uemail",null),console.log("LSlogLO::",localStorage.getItem("isLoggedIn"),localStorage.getItem("uemail")),s("/sh-chat-fe/login"))}return a.useEffect(()=>{N(t,r)},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:d.uemailWrapper,children:[e.jsx("label",{className:d.uemailText,children:m?.uemail}),e.jsxs("button",{className:d.optionsWrapper,onClick:()=>{l(!0),console.log("#15",c)},children:[e.jsx("div",{className:"options-dot"}),e.jsx("div",{className:"options-dot"}),e.jsx("div",{className:"options-dot"})]}),e.jsx(w,{showPopup:c,setShowPopup:l,children:e.jsx("div",{className:d.logoutButton,onClick:()=>p(),children:"Log out"})})]})})}const I="_theme-wrapper_15zwm_3",F="_theme-wrapper-mods-for-frame_15zwm_11",T="_theme-name_15zwm_16",y="_theme-prev_15zwm_24",$="_theme-prev-text_15zwm_39",n={themeWrapper:I,themeWrapperModsForFrame:F,themeName:T,themePrev:y,themePrevText:$};function z(){const[m,r]=a.useState(u()),s=u(void 0,!0),[c,l]=a.useState(!1);return e.jsxs("div",{className:n.themeWrapper,children:[e.jsx("div",{className:`${n.themeName} f-nunito`,children:s.get(u()).name}),e.jsx("button",{className:n.themePrev,onClick:()=>l(!0),children:e.jsx("span",{className:`${n.themePrevText} f-nunito`,children:"Sh-chat"})}),e.jsx(w,{showPopup:c,setShowPopup:l,children:[...s].map(t=>e.jsxs("div",{className:`${n.themeWrapper} ${n.themeWrapperModsForFrame}`,onClick:()=>u(t[0]),children:[e.jsx("div",{className:`${n.themeName} f-nunito`,children:t[1].name}),e.jsx("div",{className:n.themePrev,style:{background:t[1].bg},children:e.jsx("span",{className:`${n.themePrevText} f-nunito`,style:{color:t[1].text},children:"Sh-chat"})})]},t[0]))})]})}function B(){const m=v(),{SERVER_IP:r,profileData:s,setProfileData:c,makeContactsMap:l,contactsMap:t}=a.useContext(x),[p,h]=a.useState(!1),[M,R]=a.useState("");let i=a.useRef(null);async function _(){try{console.log("i work@21");const o=await k.post(`${r}/profile/nickname`,{nickname:i.current.value},{withCredentials:!0});o.data.code?(await g.contacts.where("uemail").equals(s.uemail).modify({nickname:o.data.nickname}),await N(r,c),await l(),console.log("big21::",o.data,t.get("man@sh.sh"),"cm:",t)):console.error("nickname update failed",o.data.codeMsg);const f=await g.contacts.where("uemail").equals("man@sh.sh").first();console.log("see:::",f)}catch(o){console.error("debug::handleSaveNickname: nickname update failed",o)}}function b(){i.current&&(i.current.size=i.current.value.length>0?i.current.value.length:1)}return a.useEffect(()=>{b(),i.current&&i.current.focus()},[s,p]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"settings-page-wrapper",children:[e.jsxs("div",{className:"profile-pic-wrapper",children:[e.jsx("button",{className:"settings-back-button",onClick:()=>{m("/sh-chat-fe/")},children:"â†©"}),e.jsx("div",{className:"profile-pic profile-pic-img f-fbm",children:s?.nickname.slice(0,1).toUpperCase()}),p?e.jsxs("div",{className:"profile-name-wrapper",children:[e.jsx("input",{className:"profile-name-input f-m",ref:i,value:s.nickname,size:"",onInput:o=>{c(f=>({...f,nickname:o.target.value}))}}),e.jsx("button",{className:"nickname-button nickname-save",onClick:()=>{_(),h(!1)},children:"âœ“"})]}):e.jsxs("div",{className:"profile-name-wrapper",children:[e.jsx("p",{className:"profile-name-label f-m",children:s?.nickname}),e.jsx("button",{className:"nickname-button nickname-edit ",onClick:()=>h(!0),children:"ðŸ–‰"})]})]}),e.jsxs("div",{className:"settings-items-area-wrapper",children:[e.jsx(j,{label:"Email",Component:e.jsx(E,{})}),e.jsx(j,{label:"Theme",Component:e.jsx(z,{})})]})]})})}export{B as default};
