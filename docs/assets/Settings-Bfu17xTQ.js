import{j as e,r as a,C as g,u as v,i as _,f as N,t as u,c as I}from"./index-CUeXszVH.js";import{P as b}from"./PopMenuFrame-Cr5ON83u.js";import{c as f}from"./x-DcOQVXqo.js";import{A as y}from"./arrow-left-c9ivOVQ2.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],W=f("check",P);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],k=f("external-link",L);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],$=f("pencil",z);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],M=f("undo-2",E);function h({label:m,Component:c}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"settings-item-wrapper",children:[e.jsx("label",{className:"settings-item-name f-nunito",children:m}),e.jsx("div",{className:"settings-item-action-component",children:c})]})})}const q="_uemail-wrapper_16smm_3",F="_uemail-text_16smm_11",T="_options-wrapper_16smm_19",R="_logout-button_16smm_32",x={uemailWrapper:q,uemailText:F,optionsWrapper:T,logoutButton:R};function B(){const{profileData:m,setProfileData:c}=a.useContext(g),t=v(),[o,l]=a.useState(!1),{SERVER_IP:s}=a.useContext(g);async function d(){(await N.get(s+"/auth/logout",{withCredentials:!0})).data.code&&(localStorage.setItem("isLoggedIn",!1),localStorage.setItem("uemail",null),console.log("LSlogLO::",localStorage.getItem("isLoggedIn"),localStorage.getItem("uemail")),t("/sh-chat-fe/login"))}return a.useEffect(()=>{_(s,c)},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:x.uemailWrapper,children:[e.jsx("label",{className:x.uemailText,children:m?.uemail}),e.jsxs("button",{className:x.optionsWrapper,onClick:()=>{l(!0),console.log("#15",o)},children:[e.jsx("div",{className:"options-dot"}),e.jsx("div",{className:"options-dot"}),e.jsx("div",{className:"options-dot"})]}),e.jsx(b,{showPopup:o,setShowPopup:l,children:e.jsx("div",{className:x.logoutButton,onClick:()=>d(),children:"Log out"})})]})})}const D="_theme-wrapper_15zwm_3",H="_theme-wrapper-mods-for-frame_15zwm_11",K="_theme-name_15zwm_16",U="_theme-prev_15zwm_24",V="_theme-prev-text_15zwm_39",i={themeWrapper:D,themeWrapperModsForFrame:H,themeName:K,themePrev:U,themePrevText:V};function A(){const[m,c]=a.useState(u()),t=u(void 0,!0),[o,l]=a.useState(!1);return e.jsxs("div",{className:i.themeWrapper,children:[e.jsx("div",{className:`${i.themeName} f-nunito`,children:t.get(u()).name}),e.jsx("button",{className:i.themePrev,onClick:()=>l(!0),children:e.jsx("span",{className:`${i.themePrevText} f-nunito`,children:"Sh-chat"})}),e.jsx(b,{showPopup:o,setShowPopup:l,children:[...t].map(s=>e.jsxs("div",{className:`${i.themeWrapper} ${i.themeWrapperModsForFrame}`,onClick:()=>u(s[0]),children:[e.jsx("div",{className:`${i.themeName} f-nunito`,children:s[1].name}),e.jsx("div",{className:i.themePrev,style:{background:s[1].bg},children:e.jsx("span",{className:`${i.themePrevText} f-nunito`,style:{color:s[1].text},children:"Sh-chat"})})]},s[0]))})]})}const O="_license-wrapper_6vyvu_3",G="_license-label_6vyvu_8",J="_link_6vyvu_12",j={licenseWrapper:O,licenseLabel:G,link:J};function Q(){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:j.licenseWrapper,children:[e.jsx("div",{className:`${j.licenseLabel} f-nunito`,children:"GPL v3.0"}),e.jsxs("a",{href:"https://github.com/Kam0797/sh-chat-fe/blob/main/LICENSE",className:j.link,children:[e.jsx(k,{size:20})," "]})]})})}const X="_wrapper_q31q9_3",Y="_discuss-ideas_q31q9_11",Z="_open-issue_q31q9_11",ee="_link_q31q9_15",p={wrapper:X,discussIdeas:Y,openIssue:Z,link:ee};function se(){return e.jsx(e.Fragment,{children:e.jsx("div",{className:p.wrapper,children:e.jsxs("div",{className:p.label,children:[e.jsxs("div",{className:p.discussIdeas,children:[" Discuss ",e.jsxs("a",{className:p.link,href:"https://github.com/Kam0797/sh-chat-fe/discussions/1",children:[" ",e.jsx(k,{size:20})]})," "]})," / ",e.jsxs("div",{className:p.openIssue,children:[" Open Issue ",e.jsxs("a",{className:p.link,href:"https://github.com/Kam0797/sh-chat-fe/issues",children:[" ",e.jsx(k,{size:20})]})," "]})]})})})}function ce(){const m=v(),{SERVER_IP:c,profileData:t,setProfileData:o,makeContactsMap:l}=a.useContext(g),[s,d]=a.useState(!1);let n=a.useRef(null);async function w(){try{const r=await N.post(`${c}/profile/nickname`,{nickname:n.current.value},{withCredentials:!0});r.data.code?(await I.contacts.where("uemail").equals(t.uemail).modify({nickname:r.data.nickname}),await _(c,o),await l()):console.error("nickname update failed",r.data.codeMsg)}catch(r){console.error("debug::handleSaveNickname: nickname update failed",r)}}function S(){n.current&&(n.current.size=n.current.value.length>0?n.current.value.length:1)}return a.useEffect(()=>{S(),n.current&&n.current.focus()},[t,s]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"settings-page-wrapper",children:[e.jsxs("div",{className:"profile-pic-wrapper",children:[e.jsx("button",{className:"settings-back-button",onClick:()=>{m("/sh-chat-fe/")},children:e.jsx(y,{strokeWidth:3})}),e.jsx("div",{className:"profile-pic profile-pic-img f-fbm",children:t?.nickname.slice(0,1).toUpperCase()}),s?e.jsxs("div",{className:"profile-name-wrapper",children:[e.jsx("input",{maxLength:20,className:"profile-name-input f-m",ref:n,value:t.nickname,size:"",onInput:r=>{o(C=>({...C,nickname:r.target.value}))}}),e.jsx("button",{className:"nickname-button nickname-save",onClick:()=>{w(),d(!1)},children:e.jsx(W,{size:19,strokeWidth:4})}),e.jsx("button",{className:"nickname-button nickname-revert",onClick:async()=>{d(!1),_(c,o)},children:e.jsx(M,{size:15,strokeWidth:3})})]}):e.jsxs("div",{className:"profile-name-wrapper",children:[e.jsx("p",{className:"profile-name-label f-m add-ellipsis",children:t?.nickname}),e.jsx("button",{className:"nickname-button nickname-edit f-",onClick:()=>d(!0),children:e.jsx($,{size:17})})]})]}),e.jsxs("div",{className:"settings-items-area-wrapper",children:[e.jsx(h,{label:"Email",Component:e.jsx(B,{})}),e.jsx(h,{label:"Theme",Component:e.jsx(A,{})}),e.jsx(h,{label:"Licence",Component:e.jsx(Q,{})}),e.jsx(h,{label:"Bugs & Ideas",Component:e.jsx(se,{})})]}),e.jsx("footer",{className:"footer f-nunito",children:"Sh-chat v1.2.0"})]})})}export{ce as default};
