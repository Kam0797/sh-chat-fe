import{j as e,r as t,C as j,u as _,i as v,f as N,t as u,k as C,v as P,c as W}from"./index-BLR7uX9Y.js";import{P as b}from"./PopMenuFrame-D89SpD5q.js";import{c as f}from"./x-CnHHfTcp.js";import{A as I}from"./arrow-left-DuC4V4am.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$=f("check",L);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],k=f("external-link",E);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],F=f("pencil",M);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],z=f("undo-2",T);function h({label:n,Component:i}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"settings-item-wrapper",children:[e.jsx("label",{className:"settings-item-name f-nunito",children:n}),e.jsx("div",{className:"settings-item-action-component",children:i})]})})}const R="_uemail-wrapper_16smm_3",B="_uemail-text_16smm_11",D="_options-wrapper_16smm_19",q="_logout-button_16smm_32",x={uemailWrapper:R,uemailText:B,optionsWrapper:D,logoutButton:q};function H(){const{profileData:n,setProfileData:i}=t.useContext(j),a=_(),[c,r]=t.useState(!1),{SERVER_IP:s}=t.useContext(j);async function d(){(await N.get(s+"/auth/logout",{withCredentials:!0})).data.code&&(localStorage.setItem("isLoggedIn",!1),localStorage.setItem("uemail",null),console.log("LSlogLO::",localStorage.getItem("isLoggedIn"),localStorage.getItem("uemail")),a("/sh-chat-fe/login"))}return t.useEffect(()=>{v(s,i)},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:x.uemailWrapper,children:[e.jsx("label",{className:x.uemailText,children:n?.uemail}),e.jsxs("button",{className:x.optionsWrapper,onClick:()=>{r(!0),console.log("#15",c)},children:[e.jsx("div",{className:"options-dot"}),e.jsx("div",{className:"options-dot"}),e.jsx("div",{className:"options-dot"})]}),e.jsx(b,{showPopup:c,setShowPopup:r,children:e.jsx("div",{className:x.logoutButton,onClick:()=>d(),children:"Log out"})})]})})}const K="_theme-wrapper_2opvy_3",U="_theme-wrapper-mods-for-frame_2opvy_11",V="_theme-name_2opvy_16",A="_theme-prev_2opvy_24",G="_theme-prev-text_2opvy_39",l={themeWrapper:K,themeWrapperModsForFrame:U,themeName:V,themePrev:A,themePrevText:G};function O(){const n=u(void 0,!0),[i,a]=t.useState(!1),[c,r]=t.useState(n.get(u()).name);return t.useEffect(()=>{r(n.get(u()).name)},[c]),e.jsxs("div",{className:l.themeWrapper,children:[e.jsx("div",{className:`${l.themeName} f-nunito`,children:c}),e.jsx("button",{className:l.themePrev,onClick:()=>a(!0),children:e.jsx("span",{className:`${l.themePrevText} f-nunito`,children:"Sh-chat"})}),e.jsx(b,{showPopup:i,setShowPopup:a,children:[...n].map(s=>e.jsxs("div",{className:`${l.themeWrapper} ${l.themeWrapperModsForFrame}`,onClick:()=>r(u(s[0])),children:[e.jsx("div",{className:`${l.themeName} f-nunito`,children:s[1].name}),e.jsx("div",{className:l.themePrev,style:{background:s[1].bg},children:e.jsx("span",{className:`${l.themePrevText} f-nunito`,style:{color:s[1].text},children:"Sh-chat"})})]},s[0]))})]})}const J="_license-wrapper_6vyvu_3",Q="_license-label_6vyvu_8",X="_link_6vyvu_12",g={licenseWrapper:J,licenseLabel:Q,link:X};function Y(){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:g.licenseWrapper,children:[e.jsx("div",{className:`${g.licenseLabel} f-nunito`,children:"GPL v3.0"}),e.jsxs("a",{href:"https://github.com/Kam0797/sh-chat-fe/blob/main/LICENSE",className:g.link,children:[e.jsx(k,{size:20})," "]})]})})}const Z="_wrapper_tmd4l_3",ee="_discuss-ideas_tmd4l_11",se="_suggest_tmd4l_11",te="_link_tmd4l_16",p={wrapper:Z,discussIdeas:ee,suggest:se,link:te};function ae(){return e.jsx(e.Fragment,{children:e.jsx("div",{className:p.wrapper,children:e.jsxs("div",{className:p.label,children:[e.jsxs("div",{className:p.discussIdeas,children:[" Discuss ",e.jsxs("a",{className:p.link,href:"https://github.com/Kam0797/sh-chat-fe/discussions/1",children:[" ",e.jsx(k,{size:20})]})," "]})," | ",e.jsxs("div",{className:p.suggest,children:[" Suggest ",e.jsxs("a",{className:p.link,href:"https://github.com/Kam0797/sh-chat-fe/issues",children:[" ",e.jsx(k,{size:20})]})," "]})]})})})}function le(){const n=_(),{SERVER_IP:i,profileData:a,setProfileData:c,makeContactsMap:r}=t.useContext(j),[s,d]=t.useState(!1);let o=t.useRef(null);async function w(){try{const m=await N.post(`${i}/profile/nickname`,{nickname:o.current.value},{withCredentials:!0});m.data.code?(await W.contacts.where("uemail").equals(a.uemail).modify({nickname:m.data.nickname}),await v(i,c),await r()):console.error("nickname update failed",m.data.codeMsg)}catch(m){console.error("debug::handleSaveNickname: nickname update failed",m)}}function y(){o.current&&(o.current.size=o.current.value.length>0?o.current.value.length:1)}return t.useEffect(()=>{y(),o.current&&o.current.focus()},[a,s]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"settings-page-wrapper",children:[e.jsxs("div",{className:"profile-pic-wrapper",children:[e.jsx("button",{className:"settings-back-button",onClick:()=>{n("/sh-chat-fe/")},children:e.jsx(I,{strokeWidth:3})}),e.jsx("div",{className:"profile-pic profile-pic-img f-fbm",children:a?.nickname.slice(0,1).toUpperCase()}),s?e.jsxs("div",{className:"profile-name-wrapper",children:[e.jsx("input",{maxLength:20,className:"profile-name-input f-m",ref:o,value:a.nickname,size:"",onInput:m=>{c(S=>({...S,nickname:m.target.value}))}}),e.jsx("button",{className:"nickname-button nickname-save",onClick:()=>{w(),d(!1)},children:e.jsx($,{size:19,strokeWidth:4})}),e.jsx("button",{className:"nickname-button nickname-revert",onClick:async()=>{d(!1),v(i,c)},children:e.jsx(z,{size:15,strokeWidth:3})})]}):e.jsxs("div",{className:"profile-name-wrapper",children:[e.jsx("p",{className:"profile-name-label f-m add-ellipsis",children:a?.nickname}),e.jsx("button",{className:"nickname-button nickname-edit f-",onClick:()=>d(!0),children:e.jsx(F,{size:17})})]})]}),e.jsxs("div",{className:"settings-items-area-wrapper",children:[e.jsx(h,{label:"Email",Component:e.jsx(H,{})}),e.jsx(h,{label:"Theme",Component:e.jsx(O,{})}),e.jsx(h,{label:"Licence",Component:e.jsx(Y,{})}),e.jsx(h,{label:"Bugs & Ideas",Component:e.jsx(ae,{})})]}),e.jsxs("footer",{className:"footer f-nunito",children:[`${C} ${P}`," "]})]})})}export{le as default};
